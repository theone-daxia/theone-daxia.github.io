<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Blogs | 冲和</title><meta name=keywords content><meta name=description content="Blogs - 冲和"><meta name=author content="冲和"><link rel=canonical href=https://theone-daxia.github.io/blog/><link crossorigin=anonymous href=/assets/css/stylesheet.min.6f60056d44d3f7eb69a4bc6c332b59960f3a995802bded244750232f33713c49.css integrity="sha256-b2AFbUTT9+tppLxsMytZlg86mVgCve0kR1AjLzNxPEk=" rel="preload stylesheet" as=style><link rel=icon href=https://theone-daxia.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://theone-daxia.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://theone-daxia.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://theone-daxia.github.io/apple-touch-icon.png><link rel=mask-icon href=https://theone-daxia.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.110.0"><link rel=alternate type=application/rss+xml href=https://theone-daxia.github.io/blog/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-YBNN92PXEM"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-YBNN92PXEM",{anonymize_ip:!1})}</script><meta property="og:title" content="Blogs"><meta property="og:description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"><meta property="og:type" content="website"><meta property="og:url" content="https://theone-daxia.github.io/blog/"><meta property="og:image" content="https://theone-daxia.github.io/papermod-cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://theone-daxia.github.io/papermod-cover.png"><meta name=twitter:title content="Blogs"><meta name=twitter:description content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://theone-daxia.github.io/blog/"}]}</script></head><body class="list dark" id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://theone-daxia.github.io/ accesskey=h title="冲和 (Alt + H)">冲和</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://theone-daxia.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://theone-daxia.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://theone-daxia.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://theone-daxia.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://theone-daxia.github.io/follow_me title=关注我><span>关注我</span></a></li><li><a href=https://theone-daxia.github.io/blog/medical_beauty/project/ title=医美专区><span>医美专区</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://theone-daxia.github.io/>Home</a></div><h1>Blogs</h1></header><article class=post-entry><header class=entry-header><h2>练手小项目-Chat Demo</h2></header><section class=entry-content><p>简介 这是一个用 go 编写的聊天小项目，使用到了
go gin websocket redis // 存储过期消息、记录信息发送次数等 mysql // 存储用户信息 mongo // 存储聊天信息 目前支持的功能有：
用户注册 双人单聊 拉取历史记录 我的项目代码：https://github.com/theone-daxia/chat-demo
运行准备 下载安装 docker desktop 分别拉取 redis、mysql、mongo 镜像并运行 可用 postman 来进行请求（支持 ws 请求） 知识盘点 websocket
websocket 是一个持久化的、基于 tcp 的协议，实现了浏览器和服务器的全双工通信， 节省服务器资源并达到实时通讯的目的。
通信过程如下：
首先，客户端发起 http 请求，3次握手后，建立起 tcp 连接， http 请求里存放 websocket 相关信息，如：Upgrade、Connection、WebSocket-Version 等。 然后，服务器收到客户端的握手请求后，同样采用 http 协议回馈数据。 最后，客户端收到连接成功消息后，开始通过 tcp 传输信道进行全双工通信。 与 http 的不同点可参考：WebSocket 介绍
mongo 相关命令
容器内打开mongo mongosh // 注意：5.0版本以下才用 mongo 命令打开，
The mongo shell has been deprecated in MongoDB v5....</p></section><footer class=entry-footer><span title='2023-02-20 00:00:00 +0000 UTC'>February 20, 2023</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;冲和</footer><a class=entry-link aria-label="post link to 练手小项目-Chat Demo" href=https://theone-daxia.github.io/blog/code/go/chat-demo/></a></article><article class=post-entry><header class=entry-header><h2>练手小项目-Pacman</h2></header><section class=entry-content><p>简介 这是一个用 go 编写的终端小游戏，设计很简单：
玩家在一个迷宫中行走，上下左右控制方向； 吃蛋糕加一分，遇到怪物死亡（减一条命）且短暂延时后玩家在原始位置重生； 吃到加强弹药加十分且怪物在一段时间内变得愤怒， 没命或者按 Esc 键则退出游戏。 运行展示如下 我的项目代码：https://github.com/theone-daxia/pacman
知识盘点 打开文件
import "os" file := "maze01.txt" os.Open(file) 读取文件内容
import "bufio" scanner := bufio.NewScanner(f) for scanner.Scan() { line := scanner.Text() maze = append(maze, line) } 调用外部命令
import "os/exec" cbTerm := exec.Command("stty", "cbreak", "-echo") cbTerm.Stdin = os.Stdin err := cbTerm.Run() 终端模式
Cooked Mode Cbreak Mode Raw Mode cooked mode 是 Unix-style tty(比如 console) 处理输入的默认模式， 用户可以输入一行字符，在按回车前程序是看不到的。 在 cooked mode 下，数据在被提供给程序之前被预处理，而 raw mode 将数据按原样传递给程序而不解释任何特殊字符。...</p></section><footer class=entry-footer><span title='2023-02-20 00:00:00 +0000 UTC'>February 20, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;冲和</footer><a class=entry-link aria-label="post link to 练手小项目-Pacman" href=https://theone-daxia.github.io/blog/code/go/pacman/></a></article><article class=post-entry><header class=entry-header><h2>Homebrew 相关问题</h2></header><section class=entry-content><p>问题列表 mac 系统升级后，使用 homebrew 报错，提示 “brew-core is a shallow clone”
➜ ~ brew install docker Error: homebrew-core is a shallow clone. To `brew update`, first run: git -C /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core fetch --unshallow This command may take a few minutes to run due to the large size of the repository. This restriction has been made on GitHub's request because updating shallow clones is an extremely expensive operation due to the tree layout and traffic of Homebrew/homebrew-core and Homebrew/homebrew-cask....</p></section><footer class=entry-footer><span title='2022-12-15 00:00:00 +0000 UTC'>December 15, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;冲和</footer><a class=entry-link aria-label="post link to Homebrew 相关问题" href=https://theone-daxia.github.io/blog/code/mac/homebrew/></a></article><article class=post-entry><header class=entry-header><h2>github 克隆自己的私有仓库</h2></header><section class=entry-content><p>起因 最近换了个电脑，克隆自己的私有仓库时失败， 总是报权限相关的问题。查询文档后，找到解决办法。
文档链接：https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token
解决办法 根据文档，按照如下步骤操作：
点击个人头像，在下拉菜单中点击 Settings 点击左边菜单栏最下面的 Developer settings 点击 Personal access tokens 点击 Fine-grained tokens 点击 Generate new token 然后就是按照页面上的选项操作，比如给 token 起名、选择仓库、选择权限、选择过期时间等 最后生成 token，点击复制 再次操作克隆 git clone https://xxx，回车后会让你输入用户名和密码，密码就输入刚才复制的 token，结束！</p></section><footer class=entry-footer><span title='2022-12-01 00:00:00 +0000 UTC'>December 1, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;冲和</footer><a class=entry-link aria-label="post link to github 克隆自己的私有仓库" href=https://theone-daxia.github.io/blog/code/github/clone-private/></a></article><article class=post-entry><header class=entry-header><h2>Golang内存管理和垃圾回收</h2></header><section class=entry-content><p>前言 网上有很多讲 go gc 的文章，但大多讲的不明不白， 一些突然出现的术语更是不知从何而起，导致看过一些文章后对 gc 依旧云里雾里。 好在最近在公众号看到了一篇文章，我觉得写的很赞， 起码解答了那些突然出现的术语是什么。
我决定把它搬运到这里，手写一遍记忆更加深刻。 接下来是对原文的默写，忘了就直接抄写。
原文中会贴出一些 go 的源代码，我本地 go 版本是 1.18.2，对照看的时候会有些出入， 出入的地方我就改贴上我本地的 go 源代码。 所有图片都来源于原文，原文地址在最下面参考文献中列出。 默写加抄写 本文以 go 内存管理为切入点，再到 go 垃圾回收，系统的讲解了 go 自动内存管理系统的设计和原理。
一、TCMalloc go 的内存管理借鉴了 TCMalloc 的设计思想，TCMalloc 全称 Thread-Caching Malloc， 是 google 开发的内存分配器，为了方便理解 go 的内存管理，有必要先熟悉下 TCMalloc。
(一) Page 操作系统对内存的管理以页为单位，TCMalloc 也是这样， 只不过 TCMalloc 里的 Page 大小与操作系统里的大小不一定相等，是倍数的关系。
(二) Span 一组连续的 Page 称为 Span，比如可以有 4 个页大小的 Span，也可以有 8 个页大小的 Span。 Span 比 Page 高一个层级，是为了方便管理一定大小的内存区域， Span 是 TCMalloc 中内存管理的基本单位。...</p></section><footer class=entry-footer><span title='2022-12-01 00:00:00 +0000 UTC'>December 1, 2022</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;冲和</footer><a class=entry-link aria-label="post link to Golang内存管理和垃圾回收" href=https://theone-daxia.github.io/blog/code/go/gc/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://theone-daxia.github.io/blog/page/2/>Next Page »</a></nav></footer></main><footer class=footer><span>&copy; 2023 <a href=https://theone-daxia.github.io/>冲和</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>